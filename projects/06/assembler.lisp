#!/usr/bin/env sbcl --script

(require 'uiop)

;; Utility functions

(defun last-val (l)
  (first (last l)))

(defun dec->bin (n)
  (multiple-value-bind (r m) (floor n 2)
    (if (= n 0) nil (cons m (dec->bin r)))))

(defun dec-to-bin (n)
  (reverse (dec->bin (parse-integer n))))

(defun list-to-string (lst)
  (if (not (listp lst)) lst
      (format nil "窿祗舂┅ㄤ彐躅祓徜翎蜱弭汨狎祗舂ㄩ戾铉翳祗舂翎蜱弭祓徜翎蜱弭汨狎ㄣ镱汜翦钺翦篝蜷铉汨狎祗舂祗舂换渺狍溴骈铋糸镱ㄤ彐沆狍疳蝮弪īè骈戾钺礤洪铋翎蜱烘殪孱犴濠ㄦ殪弩趄遽横沣弩箫骈戾篝蝈犴ㄣ躜蝈铘扉铄洪铋翩矧铋横沣弩箫沲蝌孱舡扉铄┅ㄤ彐礤翳镤轭轸獒扉瀛轭篝犷沐横骠弪è镡疳蝮弪脲戾è骈戾钺礤箪雉鲠祯镡ф殪孱犴濠┅箦翩ㄦ殪弩趄遽镡戛镳孱骈戾钺礤┅┅ㄤ彐礤翳镤徜鲠钽è镡疳蝮弪┅ㄩㄨ狍盹蝈泔眄犷潴镡戛戾è扉铄篝蜷铉趄轫ㄦ轵篝蹰镳后痨轸篝蜷铉蝈徜扉铄ㄦ殪弩趄遽镡戛后屦狎狒矧┅┅ㄩㄩ蟓轭鲠扉洵扉铄镡扉铄ㄡ漩犷沐镡戛箦翩ㄣ躜蝈铘扉铄镡戛扉铄┅箦翩ㄣ躜蝈铘扉铄镡戛铋飑┅ㄤ彐礤翳镤轶轭鲠扉洵扉铄è镡疳蝮弪扉铄矧铛祆扉铄ㄥ戾铉翳扉铄┅ㄡ钿戾铉翳扉铄暴篝蜷铉篚怏羼扉铄博┅┅ㄤ彐礤翳镤栳蟓盹蝈泔眄犷潴è镡疳蝮弪┅铒铛祆疱咫汨狎ㄦ殪弩趄遽镡戛铋飑┅ㄤ彐礤翳镤泔眄犷洵豉疱è镡疳蝮弪┅戾舄è扉铄ㄣ躜蝈铘扉铄镡戛ㄦ轵篝汨狎ㄣ栳扉铄癌┅ㄣ镱è羼＼骈蝮舡汨狎⒘呙贤土文è羼＼骈蝮舡汨狎⑻呙贤土文⒚呙贤土文┅┅ㄤ彐礤翳镤岘泔眄犷淇è镡疳蝮弪┅篝蜷铉ㄣ镯磲钿豉疱镡戛⒘呙贤土文┅ㄤ彐礤翳镤飙泔眄犷淇è镡疳蝮弪┅篝蜷铉ㄣ镯磲钿豉疱镡戛⑻呙贤土文┅ㄤ彐礤翳镤悱泔眄犷淇è镡疳蝮弪┅篝蜷铉ㄣ镯磲钿豉疱镡戛⒚呙贤土文┅ㄤ彐礤翳镤翳瀛簌礅镬è镡疳蝮弪┅戾舄è豉疱ㄣ镯磲钿豉疱镡戛扉铄ㄣ躜蝈铘扉铄镡戛┅ㄣ镱è岘泔眄犷淇镡戛篚怏羼扉铄暴è飙泔眄犷淇镡戛篝蜷铉趄轫ī扉铄┅┅ㄤ彐礤翳镤溴篝è镡疳蝮弪┅戾è扉铄ㄣ躜蝈铘扉铄镡戛┅ㄩㄣ泔眄犷淇镡戛ㄩ铒铛祆ㄦ轭＼扉铄┅ㄦ轵篝蹰镳后痨轸篝蜷铉扉铄后屦狎狒矧⒔┅┅┅ㄤ彐礤翳镤泔眇è镡疳蝮弪┅ㄩㄣ泔眄犷淇镡戛戾舄è扉铄ㄣ躜蝈铘扉铄镡戛蜷玷舡箝溴灬篝鲠蹰镳后痨轸篝蜷铉扉铄后屦狎狒矧⒔┅箴扉舡镱箦黹泔祜蹰镳后痨轸篝蜷铉蜷玷舡箝溴后屦狎狒矧⒒┅鲠ㄦ轵篝箴扉舡镱箦黹泔祜瞟┅ㄩ戾铉翳鲠飑癌鲠飑┅ㄤ彐礤翳镤牾眇è镡疳蝮弪┅ㄩㄣ泔眄犷淇镡戛灬篝鲠蹰镳后痨轸篝蜷铉ㄣ躜蝈铘扉铄镡戛后屦狎狒矧⒒┅┅ㄤ彐沆狍泔溴īè鲠洪铋翎蜱忽犰┅ㄤ彐礤翳镤泔溴溴篝è镡泔溴眍屙镱殂戾è箫螋邃眍屙镱殂箫螋眍屙镱殂＇汨狎戾篌皓┅ㄣ镱è铛祆箫螋邃眍屙镱殂鞍阿è篝蜷铉⑼箫螋邃眍屙镱殂鞍雹è篝蜷铉⒛箫螋邃眍屙镱殂氨阿è篝蜷铉⒛廷箫螋邃眍屙镱殂氨雹è篝蜷铉⒘箫螋邃眍屙镱殂⒈鞍è篝蜷铉⒘廷箫螋邃眍屙镱殂⒈氨è篝蜷铉⒘蘑箫螋邃眍屙镱殂⒈卑è篝蜷铉⒘耐箫螋邃眍屙镱殂⒈北┅┅ㄤ彐礤翳镤泔溴泔眇è镡泔溴眍屙镱殂ㄣ镱è篝蜷铉阿眍屙镱殂氨氨氨阿è篝蜷铉⒈眍屙镱殂氨北北雹è篝蜷铉雹眍屙镱殂氨北氨阿è篝蜷铉⒛眍屙镱殂鞍氨卑阿è篝蜷铉⒘眍屙镱殂氨卑鞍阿è篝蜷铉⑼眍屙镱殂⒈北鞍鞍è篝蜷铉∧眍屙镱殂鞍氨卑雹è篝蜷铉×眍屙镱殂氨卑鞍雹è篝蜷铉⊥眍屙镱殂⒈北鞍氨è篝蜷铉蘑眍屙镱殂鞍氨北雹è篝蜷铉立眍屙镱殂氨卑氨雹è篝蜷铉廷眍屙镱殂⒈北鞍北è篝蜷铉⒛雹眍屙镱殂鞍北北雹è篝蜷铉⒈蘑眍屙镱殂鞍北北雹蝈鲥蝮邃è篝蜷铉⒘雹眍屙镱殂氨卑北雹è篝蜷铉⒈立眍屙镱殂氨卑北雹蝈鲥蝮邃è篝蜷铉⑼雹眍屙镱殂⒈北氨北è篝蜷铉⒈廷眍屙镱殂⒈北氨北蝈鲥蝮邃è篝蜷铉⒛雹眍屙镱殂鞍氨北阿è篝蜷铉⒘雹眍屙镱殂氨卑氨阿è篝蜷铉⑼雹眍屙镱殂⒈北鞍卑è篝蜷铉⒛立眍屙镱殂鞍鞍氨阿è篝蜷铉⒘蘑眍屙镱殂鞍鞍氨阿蝈鲥蝮邃è篝蜷铉⒛廷眍屙镱殂⒈鞍鞍卑è篝蜷铉⑼蘑眍屙镱殂⒈鞍鞍卑蝈鲥蝮邃è篝蜷铉⒛立眍屙镱殂鞍卑氨雹è篝蜷铉⒛廷眍屙镱殂⒈氨鞍北è篝蜷铉⒘蘑眍屙镱殂鞍鞍北雹è篝蜷铉⑼蘑眍屙镱殂⒈鞍氨北è篝蜷铉⒛α眍屙镱殂鞍鞍鞍阿è篝蜷铉⒘δ眍屙镱殂鞍鞍鞍阿蝈鲥蝮邃è篝蜷铉⒛ν眍屙镱殂⒈鞍鞍鞍è篝蜷铉⑼δ眍屙镱殂⒈鞍鞍鞍蝈鲥蝮邃è篝蜷铉⒛立眍屙镱殂鞍卑卑雹è篝蜷铉⒘蘑眍屙镱殂鞍卑卑雹蝈鲥蝮邃è篝蜷铉⒛廷眍屙镱殂⒈氨氨氨è篝蜷铉⑼蘑眍屙镱殂⒈氨氨氨蝈鲥蝮邃┅ㄤ彐礤翳镤泔溴牾眇è镡泔溴眍屙镱殂ㄣ镱è铛祆眍屙镱殂鞍阿è篝蜷铉⑹窃眍屙镱殂鞍雹è篝蜷铉⑹叛眍屙镱殂氨阿è篝蜷铉⑹桥眍屙镱殂氨雹è篝蜷铉⑹淘眍屙镱殂⒈鞍è篝蜷铉⑹闻眍屙镱殂⒈氨è篝蜷铉⑹膛眍屙镱殂⒈卑è篝蜷铉⑹托眍屙镱殂⒈北┅ㄤ彐躅泔铙趄蹉舡秕麴豸骈戾钺礤ㄩ瞟ㄣ镱汜翦钺翦篝蜷铉篚怏羼轭ō戾铉翳轭穿栳汶┅ㄤ彐躅磲轭ㄡ蜱雯戾舄è轭瘐舡骈戾钺礤蹰镳侯狒轹瀛钺礤篝蜷铉狎琏┅í疳蝮弪磲脲轭篝犷沐ю狎箦烘殪孱犴轭瘐舡骈戾钺礤┅í秕麴豸骈戾钺礤ㄣ镱篝蝓泗秕麴豸骈戾钺礤轭瘐舡骈戾钺礤┅í泔溴磲脲轭篝犷沐с镤忽犰暴┅换箦翩ㄣ躜蝈铘扉铄疳蝮弪⒛搅换黩轸瀛扉铄ㄣ镱汜翦钺翦篝蜷铉换⒈北换ㄣ镤瀛泔眇泔溴ㄣ镯疳蝮弪┅换ㄣ镤瀛溴篝泔溴ㄤ弩疳蝮弪┅换ㄣ镤瀛牾眇泔溴牾眇疳蝮弪┅┅┅鏖翳镳孱骈戾篝蝈犴秕麴豸骈戾钺礤轰轵邈糸镱猴豸瘐洪姝屮轶趔后躔弪箦溴祜镳麒殪ㄨ狍盹蝈泔眄犷潴疳蝮弪滹ㄡ漩犷沐疳蝮弪戾è扉铄ㄣ镱è悱泔眄犷淇疳蝮弪ㄣ镱汜翦钺翦篝蜷铉⒈北ㄣ镤瀛泔眇泔溴ㄣ镯疳蝮弪┅ㄣ镤瀛溴篝泔溴ㄤ弩疳蝮弪┅ㄣ镤瀛牾眇泔溴牾眇疳蝮弪┅┅è岘泔眄犷淇疳蝮弪ㄤ邈麸忾翳瀛簌礅镬疳蝮弪┅┅┅换ㄩㄡ钿ㄣ泔眄犷淇疳蝮弪铛祆牾眇疳蝮弪┅换黩轸瀛扉铄ㄣ镤瀛牾眇泔溴牾眇疳蝮弪┅┅花黩轸瀛扉铄ㄣ镱汜翦钺翦篝蜷铉ㄣ躜蝈铘扉铄疳蝮弪劲ㄣ镯磲钿豉疱疳蝮弪┅┅花黩轸瀛扉铄矧ㄣ镤瀛溴篝泔溴ㄤ弩疳蝮弪┅ㄣ镱汜翦钺翦篝蜷铉⑽仗烫烫ㄤ弩疳蝮弪┅┅花黩轸瀛扉铄扉篝麸篝蜷铉扉篝扉篝麸篝蜷铉扉铄⒔浇劲祓徜倍阿扉篝麸篝蜷铉扉铄┅┅花黩轸瀛扉铄ㄣ镱汜翦钺翦篝蜷铉祓徜倍阿扉篝麸篝蜷铉扉铄┅劲ㄣ躜蝈铘扉铄疳蝮弪┅┅⑻晌藕痱轭ㄣ躜蝈铘扉铄疳蝮弪┅痱轭劲痱轭⒅撂痱轭扉篝ㄣ镤瀛泔眇泔溴ㄣ镯疳蝮弪┅ㄣ泔眄犷淇疳蝮弪┅痱轭⑴文花骘蝽狒祓徜倍阿扉篝麸篝蜷铉扉铄┅┅┅花黩轸瀛扉铄ㄣ镱汜翦钺翦篝蜷铉ㄣ躜蝈铘扉铄疳蝮弪劲祓徜倍阿扉篝麸篝蜷铉扉铄┅┅┅┅┅花轸弪┅┅花轸弪┅┅磲轭箦泔钿痫箝狎琏┅